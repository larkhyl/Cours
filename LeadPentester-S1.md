# Lead Pentester Semaine 1

# Contexte

Une personne ayant intégré les enjeux de sécurité d’un système d’informations, et  de fait capable d’estimer les impacts et conséquences d’un incident de sécurité  pour son client

## Définitions

**Hack Value :** Les hackers emploient ce terme pour déterminer si une  
cible est intéressante ou en vaut la peine.  

**Daisy Chaining :** Le principe est d’obtenir l’accès à un réseau ou un  
ordinateur, puis de réutiliser les mêmes informations pour se connecter  
à d’autres systèmes (password re-use).  

**Doxing :** Publication d’informations nominatives à partir de données  
publiques ou provenant de réseaux sociaux.  (google)

**Worst Plan :** La pire situation possible se produit (Exemple : le test  
d’intrusion endommage des services critiques du client, quel est le  
plan ?).  

**RoE :** Rules of Engagement. Fait référence au contrat de  
pré-engagement d’un test d’intrusion.

**Vulnérabilité :** Existence d’une faiblesse de conception ou  
d’implémentation pouvant mener à la compromission d’un système.  

**Exploit :** Code, requête permettant d’exploiter la vulnérabilité.  

**Payload :** C’est une partie du code d’un Exploit, visant à accomplir une  
action attendue comme la destruction, le vol, la création d’une porte  
dérobée ...

## Elements clés de la sécurité d'un SI

**Confidentialité :** Assurance que l’information ne soit accessible que  
pour les personnes autorisées.  

**Intégrité :** Fiabilité d’une donnée ou d’une ressource assurant  
l’impossibilité de toute modification non légitime.  

**Disponibilité :** Assurance de la réactivité et de l’accessibilité d’un  
système traitant de l’information.  

**Authenticité :** Caractéristique permettant d’assurer l’origine véritable  
pour une communication, un document, ou encore toute forme de  
données.  

**Non-Répudiation / tracabilité** : Garantie basée sur un historique (logs)  
permettant d’éviter tout débat sur ce qui a pu se passer.

## Catégories de menace

- Réseau
- Hote
- Application

## Défense en profondeur
- Approche en "couches" (physique, réseau, host, app etc)
- Mesures différentes suivant les couches

## Différentes zones

**Internet :** Zone publique non contrôlée située à l’extérieur du  
périmètre de l’organisation.  

**DMZ :** Zone contrôlée par l’organisation permettant d’isoler le réseau  
interne de la zone internet publique.  

**Production :** Zone restreinte où tous les accès provenant de zones non  
contrôlées sont analysés.  

**Intranet :** Zone contrôlée mais sans lourdes restrictions.  

**Gestion :** Zone sécurisée avec des stratégies strictes et servant à  
l’administration des différents systèmes.

## Types d'intrusions

- Sécurité physique
- Sécurité numérique

**PSSI :** Politique de sécurité du système d’information, régissant les  
pratique lié à la sécurité de l’organisation

**Prévention :** Prévention des intrusions au travers de divers  
mécanismes de contrôle d’accès  
Exemples : Verrous, digicodes, gardiens ...  

**Détection :** Détection et enregistrement de toute tentative d’intrusion  
Exemples : Détecteurs de mouvements, alarmes, capteurs,  
vidéo-surveillance ...  

**Dissuasion :** Méthodes de découragement par l’utilisation de  
messages d’avertissements visant à dissuader tout éventuel attaquant.  

**Récupération :** Systèmes de récupération opérationnelle des activités  
de l’organisation  
Exemples : Disaster recovery, PRA/PCA, solutions de sauvegarde ...  

**Compensation** : Solutions de remplacement visant à anticiper la  
menace  
Exemples : Site de bascule, groupes électrogènes

## Les types de contrôles

**Identification :** Permet de rattacher un individu à une identité unique.  
**Authentification :** Valide l’identité de l’individu.  
**Contrôle d’accès :** Permet de s’assurer que l’identité authentifiée est  
autorisée ou non à accéder à l’information.  
**Autorisation :** Vérifie pour les personnes autorisées, quel niveau  
d’autorisation elles ont vis-à-vis de l’information.  
**Accounting :** Permet de suivre les diverses actions pour un certain  
nombre, ou l’ensembles des identités recensées.  
**Cryptographie :** Mesures pouvant être implémentées pour le  
chiffrement des données, stockées, traitées, ou en mouvement, afin de  
garantir leur intégrité.  
**Stratégies de sécurité :** Mesures décidées par la haute direction, quant  
à la sécurité du système d’information du groupe donné. 

## Test d'intrusion

méthode d'évaluation de la sécurité d'un système ou d'un réseau informatique

**RedTeam :** L’auditeur ne dispose d’aucune informations, il s’agit  
de simuler une attaque en conditions réel sans se faire repérer  
(Accès physique, Vol de matériel, Accès depuis l'extérieur, …),  

**BlackBox :** Le Lead Pentesteur ne dispose pas d’information sur  
la structure visée. Il s’agit de simuler une attaque externe.  

**GreyBox :** Le Lead Pentesteur dispose d’informations limitées  
sur la structure visée. Il s’agit de simuler le cas de figure d’un  
ancien collaborateur ne possédant que des informations  
partielles.  

**WhiteBox :** Le Lead Pentesteur dispose de toutes les  
informations nécessaires sur la structure visée. Cette approche  
permet de simuler une attaque interne menée par un  
collaborateur

## Audit de sécurité

**Blue team:** consiste à auditer le système d’informations afin d’évaluer si les  
contrôles de sécurité en place sont efficients et adaptés

**Red team:** A distinguer des tests d’intrusion, l’approche consiste à porter atteinte au SI  
sans information donnée, avec intervention physique possible comme des  
attaquants réels

**Purple team:** améliorer le partage d'informations entre les équipes rouge et  bleues

## Les phases

 1. Reconnaisance
 2. Enumération
 3. Exploitation
 4. Post-exploitation

## Reconnaissance

- Information Gathering / OSINT
- Passive: pas d'interaction (enregistrement publiques)
- Active: interaction avec la cible (appels)

## Enumeration

La phase d’énumération consiste à collecter des informations de  
manière active, principalement via des techniques de scanning

## Exploitation

Il s’agit de la phase où un attaquant obtient un accès à un système  
d’exploitation, une application, ou encore un réseau.

## Post-exploitation

Il s’agit de la phase ou un attaquant va tenter de s'élever en privilèges et d’établir une Persistance  sur le système compromis afin de pouvoir revenir si nécessaire.

## OSSTMM

Manuel de bonnes pratiques pour les tests de sécurité de systèmes Open Source

## OWASP

IL représente un cadre qui aide les  organisations à tester leurs applications Web afin de créer des  logiciels fiables et sécurisés

## PTES

 1. Pré-engagement
 2. Collecte d'information
 3. Modélisation de la menace
 4. Analyse de vulnérabilité
 5. Exploitation
 6. Post-Exploitation
 7. Rapport
 
## MITRE ATT&CK

- Base de connaissance de techniques d’attaque regroupées par phases  
- Framework permettant la modélisation d’attaque ou de menace (Threat Modeling)  très utile pour la réalisation d’arbres d’attaque


# Cadrage

Les objectifs d’un test d’intrusion ne sont pas uniquement ce  que le client demande, mais un ajustement permettant d’éviter toute  insatisfaction ou inutilité.

- questionnaire
- définition des objectifs
- définition du périmètre (sites, réseau, dates)
- Estimation du temps
- Tiers?
- Ingénierie sociale?
- ddos?

### RoE

Représente la pierre angulaire d’un test d’intrusion.  
- Objectifs  
- Délai de paiement  
- Cadre de communication  
- Fréquence de livraison des rapports

# Préparation

- Distribution de sécurité Linux (Kali Linux, Parrot Security) 
- Windows avec les outils d’administration et sécurité (Commando VM)

Certains langages sont préinstallés et très utilisés pour la partie offensive :  
- PowerShell pour l’environnement Microsoft (Préinstallé)  
- Bash / Python pour l'environnement web et Linux (Préinstallé)

**rubber ducky:** est une des armes favorites des pentesters, il s’agit d’une clef  USB qui émule un clavier et exécutera un jeu de touche et combinaison lorsqu’elle  sera connectée

**lan turtle** et **paquet squirrel** permettent d’obtenir un accès à un réseau  
distant dès lors qu’un accès physique a été possible pour le connecter, il permet  également le sniffing des flux du poste sur lequel il est branché

**Wifi Pineapple:** permet de déployer des rogues access point pour effectuer des  attaques par phishing et d’effectuer des attaques active ou passive (scan,  interception par le wifi)  

**HackRF**: permet d’effectuer des attaques radio en émission et réception avec  n’importe quel type de modulation. Il est surtout utilisé lorsque des détecteurs,  GPS, talky-walky ou téléphones sont utilisés.

**lockpicking:** l’art du crochetage de serrure, parfois en mission RedTeam  
cette activité est indispensable. 

**loot :** Informations intéressante obtenue pendant le test d’intrusion  
(mots de passes, documents sensibles, emails, …)

# Collecte d'informations

**OSINT:** Open Source INTelligence est une pratique  consistant à collecter des informations auprès de  différentes sources publiques

- **Passif :** aucune interaction n’est effectuée avec l’hôte ou l’ élément ciblé.  
- **Actif :** l’attaquant entre en contact avec sa cible.

## Outils OSINT

### Les opérateurs de recherche Google (google dorks)
Recherche google plus précises et efficaces

### Whois / DNS  
Rechercher des noms de domaines ou de sous-domaines :

### Google Hacking Database  

La “Google Hacking Database” est une Source autorisée de requêtes  
Google engine.

### Metagoofil

Outil d’information gathering pour extraire les documents public associés à un  
domaine, entité sur le net  
- Utilise les google dorks  
- Extrait les métadonnée des documents identifiés

### TheHarvester  
 Outil d’OSINT recherchant l’exposition sur internet  
- Recherche des adresses mails  
- Domaines, sous-domaines  
- IP et URL

### Dmitry  
Outil d'énumération et reconnaissance permettant une reconnaissance assez  
complète :  
- Recherche des adresses mails  
- Domaines, sous-domaines  
- Whois  
- Informations sur les serveurs  
- Scan de port

### Systèmes d'exploitations
Identification de systèmes et de  programmes, Versions de releases, Objets connectés etc

### Réseaux sociaux
Les attaquants utilisent des techniques d'ingénierie sociale dans le but  d’obtenir des informations sensibles.

### Maltego

Outil de reconnaissance passive et collecte d’information graphique, il  permet de créer des entités pour représenter tout type d’informations

### Sites webs

**archive.org:** permet de retrouver un historique des versions archivées de  sites web

### Autres méthodes

- TLDs et sous-domaines 
- Localisation géographique
- Informations financières 
- Pistage de mail

# Enumeration

Consiste à sonder un environnement pour y obtenir  plusieurs informations :  
- Présences de machines sur le sous-réseau  
- Plan et segmentation réseau  
- Souvent assimilé au scanning, il peut également consister à rechercher  
et lister les protocoles présents

## Découverte du voisinage

**netdiscover:** permet d’énumérer un réseau local en broadcastant des requêtes ARP sur  plusieurs segments réseaux

**p0f**: permet la reconnaissance passive du réseau (sans scan) sur les connexions reçus  
(OS, protocole, charge de la trame, …)

## SCANS

### Principe

L’émetteur envoie un paquet vers un hôte et attend une réponse de celui-ci   C’est la réponse (ou la non-réponse) à ce paquet qui va permettre d’analyser l’ état des ports et des services de l’hôte en question

### Flags

**FIN :** Annonce la fin des transmissions  
**SYN :** Initie la connection entre 2 hôtes  
**RST :** Réinitialise la connection  
**PSH :** Force l’envoi des données de tampon  
**ACK :** Approuve la réception d’un paquet  
**URG :** Les données du paquet doivent être traitées  
immédiatement

### Three-way handshake

![enter image description here](https://zupimages.net/up/20/45/atq9.png)

### Types de scans
- ICMP  
- TCP  
- UDP

### ICMP

**Ping :** Le scan ICMP représente un simple scan visant à déterminer l’activité d’un hôte  
**Ping Sweep :**  Pareil mais sur un sous-réseau

**Pour être safe:**
- Ne pas répondre au PING
- Ne pas envoyer de "reset" lors d'une tentative de connexion

### Full Open Scan (TCP Connect) 

établie la session TCP

![enter image description here](https://zupimages.net/up/20/45/oenf.png)

### Half-Open Scan (Stealth) ou SYN :** 
initie la session TCP puis interrompt la  connection 

![enter image description here](https://zupimages.net/up/20/45/oyzx.png)

### NULL Scan
envoi d’un paquet “Sonde” (probe packet) sans flag.  

![enter image description here](https://zupimages.net/up/20/45/9ao1.png)

### Xmas Scan
envoi d’une trame TCP avec les flags (URG/PSH/FIN).

![enter image description here](https://zupimages.net/up/20/45/wgn9.png)


![enter image description here](https://zupimages.net/up/20/45/xdun.png)

### Pour résumer

- Les TCP Open ou NULL scan vont vérifier si les ports sont ouverts ou fermé  
- Tandis que Le TCP ACK scan a pour but de vérifier si un filtrage est actif  
- le XMAS quant à lui tentera de déjouer certains pare-feu avec des flags non  commun

### SCAN UDP

Protocole sans connexion: si le port est ouvert, aucun retour ne sera envoyé par le serveur ciblé

![enter image description here](https://zupimages.net/up/20/45/feg6.png)

## Banner Grabbing

Extraction des informations des  bannières pouvant contenir :  
- Des versions de systèmes  d’exploitation  
- Des versions de services
- actif et passif

## Contournement de pare-feu IDS

**Fragmentation de paquets :** Envoi de paquets “sonde” fragmentés,  
c’est le serveur qui les reçoit qui rassemble les paquets avant lecture.  

**Routage Source :** Envoi de paquets en spécifiant le routage souhaité  
pour atteindre leur cible, et ainsi éviter les différents éléments de  
détection.  

**Adresse IP leurre :** Envoi de paquets en générant ou spécifiant une  
adresse IP leurre (Decoy) afin de dissimuler l’adresse de l’émetteur.  

**Usurpation d’adresse IP :** Changement de l’adresse IP de l’émetteur  
dans le but que les paquets envoyés semblent provenir d’un autre  
émetteur.  

**Serveur Proxy :** Utilisation d’une chaîne de serveurs proxy pour cacher  
l’adresse d’origine de l’émetteur et ainsi contourner certaines  
restrictions d’IDS et de pares-feu.

## Enumération de protocoles

### Ce que l'on recherche

- Mots de passe par défaut
- Partage de fichiers
- Groupe de users
- Services obsolètes
- zone dns
- Config par défaut

### Cibles prioritaires

**Samba:** partage de fichiers (utiliser **smbclient, smbmap, nmap**)

**RPC:** Permet l’administration distante de serveurs  voire d’un domaine entier (utiliser **enum4linux, rpcclient**)

**NFS:** partage de fichiers (utiliser **showmount** ou **nmap**)

**SNMP:** Le protocole SNMP est souvent délaissé avec sa communauté par défaut qui est parfois configuré en écriture et qui circule en clair sur le réseau

**SMTP**: L’énumération du protocole SMTP peut s’avérer intéressante pour vérifier l’existence de comptes  

**DNS**: Un serveur DNS peut fournir des informations utiles pour cartographier un réseau et récupérer la liste des machines du réseau (**transfert de zone**)

**IPSEC:** L’énumération du protocole IPsec permet d’identifier des flux de communications sensibles et de récupérer les informations relatives aux VPN

**VOIP:** permet d'usurper une idendité

# Analyse de vulnérabilités
Il s’agit d’examiner la capacité d’un système ou d’une application à  
résister aux assauts.

Les vulnérabilités sont identifiées, mesurées, et classifiées selon 3  
catégories (système, réseau, canaux de communication)

**CVE: Common Vulnerability and Exposure” :**  
Dictionnaire d’identifiants normalisés pour les logiciels exposés  
ou présentant des vulnérabilités.  

**CVSS :“Common Vulnerability Scoring System” :**  
Système de notation pour les vulnérabilités.

**NVD “National Vulnerability Database” :** 
Dépôt de données de gestion  des Standard de vulnérabilités normées.

**CERT (Computer Emergency Response Team) :**
Son  but, renforcer la protection des réseaux de l’État contre les attaques  
numériques.

**CERT FR**
point de contact international privilégié pour tout incident de  
nature cyber touchant la France

## Outils

### Nessus

- Nessus est un outil payant avec une version communautaire d’essai (16 scan max)  
- Détection de vulnérabilité par réseau en corrélant version de service à sa base de  donnée de vulnérabilités connues  
- Détection de vulnérabilité local en récupérant la liste de logiciels présent sur la machine  distante

### OpenVAS

Fork de Nessus open-source

## Vulnérabilités connues

**PoC:** Proof Of Concept

### MS17-010 "eternal blue"

Elle a été utilisé par le ransomware Wannacry, cette vulnérabilité à  affecté l’ensemble des versions de Windows lorsqu’elle a été découverte  

Celle-ci s’effectue via le protocole SMB en version 1 et 2 en corrompant les adresses  mémoires via buffer overflow par le réseau  

A la suite de cela l’attaquant injecte une DLL malveillante dans un processus système  

Une fois exploité l’attaquant a le contrôle de la machine en tant que SYSTEM

### CVE-2016-5195  Dirty cow
Vulnérabilité affectant les noyaux Linux depuis 2.6.22 jusqu’à  4.4.26  
L’exploit permet à l’attaquant local d‘obtenir un accès en écriture aux zones mémoire du  système (normalement en lecture seule)

### CVE-2014-0160 Heartbleed

La vulnérabilité affecte certaines versions d’OpenSSL elle permet  
de récupérer 64KB de la mémoire distante du processus du serveur utilisant OpenSSL  

 Souvent utilisées en contexte web, ces adresses mémoire peuvent contenir diverses choses  intéressantes comme  des clé privées du serveur  ou des clés des sessions SSL/TLS


# Exploitation

La recherche d’Exploit  consiste à :  
- Identifier des Exploits fonctionnels correspondant aux vulnérabilités  trouvées  
- Tester et valider concrètement l’applicabilité de ceux-ci

Plusieurs base de données publiques références les exploits et vulnérabilités  La plus connue est **ExploitDB**

L’outil **searchsploit** permet également de rechercher des exploits

## outils

### Metasploit

Metasploit est un outil d’exploitation et post-exploitation (en CLI) conçu pour tout type  de plateforme cible

### Colbat Strike

Cobalt Strike est une version amélioré et payante de metasploit et armitage, celui-ci  offre une interface graphique stable, rapide et de nombreuses fonctionnalité

### Empire

Empire est un projet open source ayant été repris, il s’agit d’un C2C écrit en Python et  PowerShell destiné à la post exploitation pour les environnements Windows

## Execution de charges (payload)

Celle-ci permettra d’accéder à un système / réseau distant  et d’agir sur le système et ses paramètres  

### Implantation

L’exécution d’une charge peut se faire de différentes manières :  
- Au travers d’une vulnérabilité (via un Exploit)  
- Par obtention d’une action de l’utilisateur du système cible  
- Par exécution sur le poste une fois compromis

### Reverse-shell - bind shell

Le reverse shell ou bind shell est le joker des pentesters, celui est souvent utilisé suite à  une exécution de code ou un exploit pour obtenir un shell système  
- Des utilitaires système permettent des reverses ou bind shell (netcat, …)  
- Des interpréteurs aussi (Python, Perl, PowerShell, …)

## Ecoute passive et active

Utilisée comme outils de hacking pour détecter,  intercepter et voler des informations confidentielles ou sensibles  circulant sur le réseau

**Passif :** Revient à renifler le trafic provenant d’un Hub, qui broadcast  toutes les requêtes. Aucun paquet n’est envoyé lors d’une Écoute du  réseau passif.  

**Actif :** Dans un réseau de switchs, il est nécessaire d’envoyer une  multitude de paquets ARP afin de saturer la table CAM (Content  Addressable Memory) du switch, dans le but de détourner les flux de  communication

**wireshark / tcpdump :** permet d’inspecter les paquets réseau

### protocoles vulnérables

**Telnet / Rlogin :** Toutes les frappes clavier sont envoyées en clair.  
**HTTP :** Les données sont envoyées en clair.  
**POP :** Les mots de passe et les données sont envoyés en clair.  
**IMAP :** Les mots de passe et les données sont envoyés en clair.  
**SMTP / NNTP :** Les mots de passe et les données sont envoyés en  
clair.  
**FTP :** Les mots de passe et les données sont envoyés en clair

### Switchs

**CAM Flooding :** Lorsque la table CAM est pleine,  chaque nouvelle requête ARP va  inonder les ports du switch (le transforme en HUB)

**Vol de port :**  Technique d’écoute du réseau qui  utilise du MAC Flooding  
L’attaquant inonde le switch de  paquets ARP forgés avec  l’adresse MAC de sa  cible en tant que source,  et sa propre MAC comme  adresse de destination

### DHCP

**Inondation DHCP (starvation) :**  Il s’agit d’un déni de service visant un serveur DHCP (attaque de dernière chance car facilement repérable)

**rogue:** L’attaquant monte un serveur DHCP malicieux qui va répondre aux  requêtes DHCP au travers d’une fausse adresse IP, et attribuer de mauvais adressages aux postes clients.

### DNS

**Usurpation DNS - Intranet**: Principe d’altération ou d’ajout d’enregistrements DNS forgés, dans le but de  rediriger les clients vers un site malicieux

**Empoisonnement de cache :**  Même objectif

## Bruteforcing

Un brute force représente une succession exhaustive d’essais de  
combinaisons pour obtenir une authentification.

**Attaque Incrémentielle**;  Calcul de toutes les combinaisons possibles

**Attaque par dictionnaire:**  utilisation de listes de mots de passe “connus” ou provenant d’un leak

**attaque mixte:** Couplage d’un dictionnaire à un brute force de préfixes ou suffixes

**hashid:** Permet d’identifier le type de hash et ses dérivés

**hashcat (attaque offline)**: Outil open source prenant en charge l’optimisation GPU et l'accélération  (Nécessite l’identification du format de hash)

**cewl**: Outil open source qui spider une URL à une profondeur spécifiée et renvoyant une liste  de mots pouvant être réutiliser dans un dictionnaire pour bruteforce.

**Cupp.py**: Outil open source permettant de créer du profiling de mot de passe à partir  d’informations données (date, nom, adresse, etc …)

**Hydra (attaque online)**: Hydra est un outil multithread pour le bruteforce en ligne

# Post-exploitation

La désactivation des éléments de traçabilité est utile pour :  
- Préserver la méthodologie du pentester  
- Éviter d’alerter les équipes de surveillance

**Désactiver l’audit :** Désactiver les fonctionnalités d’audit sur la  machine compromise.  

**Désactiver les logs :** Désactiver la génération des journaux système  correspondant aux actions menées par l’attaquant.  

**Manipuler les logs** : Manipuler les journaux d'événements avec  précision de manière à éviter des actions en justice.

## Désactivation de l'audit


### Linux
Désactiver l’historique du terminal Linux  

    export HISTSIZE=0  

### Windows

Changer le chemin par défaut du fichier de log PowerShell   

    Set-PSReadlineOption -HistorySavePath ‘path’  

Désactiver la fonctionnalité de log terminal PowerShell  

    Set-PSReadlineOption –HistorySaveStyle SaveNothing

## Elevation de priviléges

La commande **“system info”** permet de recueillir un certain nombre d’informations sur  un système, notamment les versions de patchs installés (KB)

### Vulnérabilités SUDO

La configuration de l’utilitaire sudo contient généralement des vulnérabilités amenant à une  compromission total d’un système :  
- Vulnérabilité sudo NOPASSWD  (lancer des commandes en sudo sans mot de passe)
-  Vulnérabilité sudo path truncation (../../../etc/passwd)

### Vulnérabilité SUID

SUID est un droit d’utilisation permettant à un utilisateur d’exécuter un fichier avec les droits de  son propriétaire  
Parfois, le SUID est mis sur des binaires permettant d’exécuter des commandes ou des erreurs  de conception permettent à l’attaquant d’obtenir un shell root

### Vulnérabilité NFS no_root_squash

Dans le protocole NFS, le paramètre root_squashing empêche l’accès aux utilisateurs root  distant en les mappant en nfsnobody  
Au contraire le  no_root_squash autorise l’accès à root 
 
Si un partage nfs est en no_root_squash et que l’attaquant le monte, il pourra y déposer  un binaire SUID lui permettant d’obtenir un shell root 

### Vulnérabilité CRON

Cron permet de planifier des tâches en tant que root.
Certains utilitaires ont aussi leur vulnérabilités pouvant amener à une compromission  root couplé à cron (tar command injection)

### Enumération local

Certains scripts permettent de faire une énumération complète d’un système local:  Utilisateurs présents, Droits d’accès, Configuration des utilitaires systèmes
*exemple: Enum4linux*

### Failles matérielles

**Meltdown :** En exploitant cette vulnérabilité, un attaquant peut élever  ses privilèges en forçant un processus illégitime à s’exécuter en lisant  une autre zone de mémoire adjacente. Cette attaque permet de révéler  des informations système critiques, des identifiants, des clés privées 

**Spectre :** Vulnérabilité située au niveau du processeur  et permet  ainsi d'accéder à des informations non  autorisées. Avec cette attaque, un hacker peut accéder à la mémoire du noyau.

### Keylogger

Il existe 2 versions de keyloggers :  
- Matériel : BIOS, clavier, externe (PS2 / USB, micro / caméra,  bluetooth / wi-fi)  
- Logiciel : Noyau, hyperviseur, application, formulaire

## Persistance

La persistance permet à un attaquant de garder un accès distant à une machine:
- Il peut s’agir d’une porte dérobée ou d’un cheval de Troie  
- Il peut également s’agir de persistance physique (via des appareils branchés  
au réseau avec clé 4G)

### Base de registre

Une des méthodes classiques pour établir une persistance est la base de  registre Windows  
**Les clés RUN** du registre permettent de lancer des programmes  automatiquement au lancement du système

### Planificateur de tâches

Le planificateur de tâches Windows est également une méthode courante pour  établir une persistance :  
Un attaquant peut s’en servir pour appeler son script malveillant à  chaque lancement de Windows

## Mouvements latéraux

Un mouvement latéral est un moyen d'atteindre un but, une technique  utilisée pour identifier, accéder et exfiltrer des données sensibles.

### Passe the credentials

Plusieurs protocoles réseaux ont leurs faiblesses, permettant à un attaquant  de s’authentifier sans pour autant connaître le mot de passe  
Sous Windows, la technique du « Pass-the-Hash » consiste à  s’authentifier sur un serveur en utilisant le hash du mot de passe d’un  utilisateur, plutôt que par le mot de passe lui même

### SSH tunneling

Cette technique utilise le protocole SSH pour “tunneler” un flux via un relai pour  atteindre un équipement situé dans un réseau privée  
De cette façon la machine compromise (le pivot) pourra forwarder le port d’une  machine distante en miroir vers un port local sur la machine de l’attaquant

### Proxy socks4a

Le principe du proxy socks4a est semblable au ssh tunneling,  cependant la distribution est différente :  
- L’attaquant route lui même ces requêtes vers le point de  pivot  
- Le point de pivot transfère les requêtes vers les  machines du sous-réseau ou tout le sous-réseau

## Nettoyage de traces

Une fois que le pentesteur a terminé son travail, il souhaite effacer toutes les  
traces de ses actions
- Par professionnalisme  
- Pour éviter d’interférer avec une éventuelle enquête ultérieure  
- Afin de ne pas générer de potentielles pertes de confidentialité,  
notamment les informations récoltées lors du test  
- Pour restituer au client un environnement fonctionnel

### audit/logs

Plusieurs consignes à ne pas négliger :  
- Penser à réactiver les stratégies d’audit :
- Sous WIndows: Supprimer les MRU (Most Recently Used) :
- Effacer l'historique (.bash_history ou clear-history)
